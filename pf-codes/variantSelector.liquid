<div name="variant-selector" class="variant-selector">
  <h3>SELECT A SIZE</h3>
  <div class="variant-options">
    {% for variant in product.variants %}
      <span
        value="{{ variant.id }}"
        class="variant-item"
        onclick="quickAddToCart({{ variant.id }});"
      >
        {{ variant.title | slice: 3, 2 }}
      </span>
    {% endfor %}
  </div>
  <script>
    function quickAddToCart(variantId) {
      console.log(variantId);
      let formData = {
        items: [
          {
            id: variantId,
            quantity: 1,
          },
        ],
        sections: 'cart-icon-bubble',
      };
      fetch(window.Shopify.routes.root + 'cart/add.js', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData),
      })
        .then(async (response) => {
          const result = await response.json();
          console.log('result', result);
          updateBubble(result.sections['cart-icon-bubble']);
          return result;
        })
        .catch((error) => {
          console.error('Error:', error);
        });
    }

    function updateBubble(par) {
      const bubble = document.getElementById('cart-icon-bubble');
      bubble.innerHTML = par;
    }
  </script>
</div>
{%- style -%}
  .variant-selector {
    display: none;
    padding: 15px 10px;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 10px;
    background-color: rgba(255, 255, 255, 0.7) !important;
  }

  .variant-selector > h3 {
    padding: 0;
    margin: 0;
    font-family: 'Roboto Mono';
    font-weight: 700;
    font-size: 14px;
  }

  .variant-options {
    display: flex;
    justify-content: center;
    gap: 5px;
  }

  .variant-item {
    width: 25px;
    height: 25px;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: white;
    color: black;
    font-family: 'Roboto Mono';
    font-weight: 700;
    font-size: 18px;
    cursor: pointer;
  }

  .variant-item:active {
    background-color: black;
    color: white;
  }
{%- endstyle -%}
